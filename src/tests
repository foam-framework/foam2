p({"class":"foam.nanos.test.Test","id":"password hashing","description":"testing password hashing dao","server":true,"scheduled":false,"code":"auth = x.get(\"auth\");\nuserDAO = x.get(\"userDAO\");\nuserDAO.removeAll();\n\n// test password hashing\nuser = new foam.nanos.auth.User();\nuser.setFirstName(\"Test\");\nuser.setLastName(\"MintChip\");\nuser.setEmail(\"test@nanopay.net\");\nuser.setPassword(\"Mintchip123\");\nresult = userDAO.put(user);\n\ntest(foam.util.SafetyUtil.isEmpty(result.getPassword()), \"password not returned following first put\");\ntest(auth.loginByEmail(x, \"test@nanopay.net\", \"Mintchip123\") != null, \"login using email and password\");\n\nresult.setPassword(\"Mintchip124\");\nresult2 = userDAO.put(result);\n\ntry {\ntest(foam.util.SafetyUtil.isEmpty(result2.getPassword()), \"password not returned following second put\");\nauth.loginByEmail(x, \"test@nanopay.net\", \"Mintchip124\");\n} catch (Throwable t) {\ntest(t.getMessage() == \"Invalid password\", \"password not updated\");\n}"})
